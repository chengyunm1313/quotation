(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const l of c)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function e(c){const l={};return c.integrity&&(l.integrity=c.integrity),c.referrerPolicy&&(l.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?l.credentials="include":c.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(c){if(c.ep)return;c.ep=!0;const l=e(c);fetch(c.href,l)}})();const v="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--logos'%20width='32'%20height='32'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%20256%20256'%3e%3cpath%20fill='%23F7DF1E'%20d='M0%200h256v256H0V0Z'%3e%3c/path%3e%3cpath%20d='m67.312%20213.932l19.59-11.856c3.78%206.701%207.218%2012.371%2015.465%2012.371c7.905%200%2012.89-3.092%2012.89-15.12v-81.798h24.057v82.138c0%2024.917-14.606%2036.259-35.916%2036.259c-19.245%200-30.416-9.967-36.087-21.996m85.07-2.576l19.588-11.341c5.157%208.421%2011.859%2014.607%2023.715%2014.607c9.969%200%2016.325-4.984%2016.325-11.858c0-8.248-6.53-11.17-17.528-15.98l-6.013-2.58c-17.357-7.387-28.87-16.667-28.87-36.257c0-18.044%2013.747-31.792%2035.228-31.792c15.294%200%2026.292%205.328%2034.196%2019.247l-18.732%2012.03c-4.125-7.389-8.591-10.31-15.465-10.31c-7.046%200-11.514%204.468-11.514%2010.31c0%207.217%204.468%2010.14%2014.778%2014.608l6.014%202.577c20.45%208.765%2031.963%2017.7%2031.963%2037.804c0%2021.654-17.012%2033.51-39.867%2033.51c-22.339%200-36.774-10.654-43.819-24.574'%3e%3c/path%3e%3c/svg%3e",w="/quotation/vite.svg";function S(o){let t=0;const e=n=>{t=n,o.innerHTML=`count is ${t}`};o.addEventListener("click",()=>e(t+1)),e(0)}document.querySelector("#app").innerHTML=`
  <div>
    <a href="https://vite.dev" target="_blank">
      <img src="${w}" class="logo" alt="Vite logo" />
    </a>
    <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript" target="_blank">
      <img src="${v}" class="logo vanilla" alt="JavaScript logo" />
    </a>
    <h1>Hello Vite!</h1>
    <div class="card">
      <button id="counter" type="button"></button>
    </div>
    <p class="read-the-docs">
      Click on the Vite logo to learn more
    </p>
  </div>
`;S(document.querySelector("#counter"));document.getElementById("quoteDate").valueAsDate=new Date;document.getElementById("generatedAt").textContent=new Date().toLocaleString();document.getElementById("itemTable").addEventListener("input",function(o){["item-qty","item-price"].some(t=>o.target.classList.contains(t))&&(i(o.target.closest("tr")),a())});window.addRow=function(){const t=document.querySelector("#itemTable tbody"),e=t.querySelector("tr").cloneNode(!0);e.querySelectorAll("input, textarea").forEach(n=>{n.type==="checkbox"?n.checked=!1:n.value=n.classList.contains("item-unit")?"組":""}),e.querySelector(".item-qty").value=1,e.querySelector(".item-price").value=0,e.querySelector(".item-subtotal").textContent="0",t.appendChild(e)};window.deleteSelected=function(){const t=document.querySelector("#itemTable tbody");t.querySelectorAll(".row-chk:checked").forEach(e=>{t.rows.length>1&&e.closest("tr").remove()}),a()};document.getElementById("addBtn")?.addEventListener("click",()=>window.addRow());document.getElementById("duplicateBtn")?.addEventListener("click",()=>window.duplicateRow());document.getElementById("deleteBtn")?.addEventListener("click",()=>window.deleteSelected());document.getElementById("colDecBtn")?.addEventListener("click",()=>window.adjustColWidth(-20));document.getElementById("colIncBtn")?.addEventListener("click",()=>window.adjustColWidth(20));document.getElementById("exportBtn")?.addEventListener("click",()=>window.exportPDF());window.toggleAll=function(t){document.querySelectorAll(".row-chk").forEach(e=>e.checked=t.checked)};function i(o){const t=parseFloat(o.querySelector(".item-qty").value)||0,e=parseFloat(o.querySelector(".item-price").value)||0,n=t*e;o.querySelector(".item-subtotal").textContent=n.toLocaleString()}function a(){const o=parseFloat(document.getElementById("taxRate").value)||0;let t=0;document.querySelectorAll(".item-subtotal").forEach(c=>{t+=parseFloat(c.textContent.replace(/,/g,""))||0});const e=Math.round(t*o/100),n=t+e;document.getElementById("subtotal").textContent=`NT$ ${t.toLocaleString()}`,document.getElementById("tax").textContent=`NT$ ${e.toLocaleString()}`,document.getElementById("total").textContent=`NT$ ${n.toLocaleString()}`}window.saveDraft=function(){const t=[];document.querySelectorAll("#itemTable tbody tr").forEach(e=>{t.push({name:e.querySelector(".item-name").value,desc:e.querySelector(".item-desc").value,unit:e.querySelector(".item-unit").value,qty:+e.querySelector(".item-qty").value||0,price:+e.querySelector(".item-price").value||0})}),localStorage.setItem("quoteDraft",JSON.stringify(t)),alert("已暫存至瀏覽器")};i(document.querySelector("#itemTable tbody tr"));a();$(function(){$("#itemTable").colResizable({liveDrag:!0,minWidth:40})});window.duplicateRow=function(){const t=document.querySelector("#itemTable tbody"),e=[...t.querySelectorAll(".row-chk:checked")];if(!e.length){alert("請先勾選要複製的列");return}e.forEach(n=>{const c=n.closest("tr").cloneNode(!0);c.querySelector(".row-chk").checked=!1,t.appendChild(c),i(c)}),a()};window.loadDraft=function(){const t=localStorage.getItem("quoteDraft");if(!t){alert("沒有暫存資料");return}try{u(JSON.parse(t))}catch{alert("暫存資料格式錯誤")}};window.clearDraft=function(){localStorage.removeItem("quoteDraft"),alert("已清除暫存")};function d(o){document.documentElement.style.setProperty("--col-name-width",`${o}px`),document.querySelectorAll("#itemTable th:nth-child(2), #itemTable td:nth-child(2)").forEach(t=>t.style.width=`${o}px`)}const s=document.getElementById("colWidthSlider");s.addEventListener("input",o=>{d(o.target.value)});d(s.value);window.adjustColWidth=function(t){const e=document.getElementById("colWidthSlider");let n=Math.min(+e.max,Math.max(+e.min,+e.value+t));e.value=n,d(n)};window.exportPDF=function(){const e=document.querySelector(".container-fluid").cloneNode(!0);e.querySelectorAll("textarea").forEach(n=>{const c=document.createElement("div");c.style.cssText="white-space:pre-wrap;border:1px solid #ced4da;padding:.5rem;border-radius:.25rem;font-size:.875rem;",c.textContent=n.value,n.replaceWith(c)}),html2pdf().set({margin:0,filename:"quotation.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2,scrollY:0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["avoid-all","css","legacy"]}}).from(e).save()};window.importFile=function(t){const e=t.target.files[0];if(!e)return;const n=new FileReader;n.onload=function(c){const l=c.target.result;try{let r=[];e.name.endsWith(".json")?r=JSON.parse(l):l.trim().split(/\r?\n/).slice(1).forEach(m=>{const[p,y,f,h,g]=m.split(",");r.push({name:p,desc:y,unit:f,qty:+h,price:+g})}),u(r)}catch{alert("檔案格式錯誤或內容無法解析")}t.target.value=""},n.readAsText(e,"utf-8")};function u(o){const t=document.querySelector("#itemTable tbody");t.innerHTML="",o.forEach(e=>{const n=document.createElement("tr");n.innerHTML=`
          <td class="text-center"><input type="checkbox" class="row-chk"></td>
          <td><input type="text" class="form-control form-control-sm item-name" value="${e.name||""}"></td>
          <td><textarea class="form-control form-control-sm item-desc" rows="1">${e.desc||""}</textarea></td>
          <td><input type="text" class="form-control form-control-sm item-unit" value="${e.unit||"組"}"></td>
          <td><input type="number" class="form-control form-control-sm item-qty" value="${e.qty||1}" min="1"></td>
          <td><input type="number" class="form-control form-control-sm item-price" value="${e.price||0}"></td>
          <td class="text-end fw-bold item-subtotal">0</td>
        `,t.appendChild(n),i(n)}),a()}document.getElementById("addBtn")?.addEventListener("click",addRow);document.getElementById("duplicateBtn")?.addEventListener("click",duplicateRow);document.getElementById("deleteBtn")?.addEventListener("click",deleteSelected);document.getElementById("colDecBtn")?.addEventListener("click",()=>adjustColWidth(-20));document.getElementById("colIncBtn")?.addEventListener("click",()=>adjustColWidth(20));document.getElementById("exportBtn")?.addEventListener("click",exportPDF);
