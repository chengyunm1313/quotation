(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function r(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(t){if(t.ep)return;t.ep=!0;const n=r(t);fetch(t.href,n)}})();document.getElementById("quoteDate").valueAsDate=new Date;document.getElementById("generatedAt").textContent=new Date().toLocaleString();document.getElementById("itemTable").addEventListener("input",function(e){["item-qty","item-price"].some(o=>e.target.classList.contains(o))&&(i(e.target.closest("tr")),a())});function i(e){const o=parseFloat(e.querySelector(".item-qty").value)||0,r=parseFloat(e.querySelector(".item-price").value)||0,l=o*r;e.querySelector(".item-subtotal").textContent=l.toLocaleString()}function a(){const e=parseFloat(document.getElementById("taxRate").value)||0;let o=0;document.querySelectorAll(".item-subtotal").forEach(t=>{o+=parseFloat(t.textContent.replace(/,/g,""))||0});const r=Math.round(o*e/100),l=o+r;document.getElementById("subtotal").textContent=`NT$ ${o.toLocaleString()}`,document.getElementById("tax").textContent=`NT$ ${r.toLocaleString()}`,document.getElementById("total").textContent=`NT$ ${l.toLocaleString()}`}i(document.querySelector("#itemTable tbody tr"));a();$(function(){$("#itemTable").colResizable({liveDrag:!0,minWidth:40})});function u(e){document.documentElement.style.setProperty("--col-name-width",`${e}px`),document.querySelectorAll("#itemTable th:nth-child(2), #itemTable td:nth-child(2)").forEach(o=>o.style.width=`${e}px`)}const s=document.getElementById("colWidthSlider");s.addEventListener("input",e=>{u(e.target.value)});u(s.value);
